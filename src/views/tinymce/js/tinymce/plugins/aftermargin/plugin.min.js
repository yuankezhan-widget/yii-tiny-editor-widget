tinymce.PluginManager.add('aftermargin', function(editor, url) {
    var pluginName='段后距';
    var global$1 = tinymce.util.Tools.resolve('tinymce.util.Tools');
    var doAct = function (value) {
        var dom = editor.dom;
        var blocks = editor.selection.getSelectedBlocks();
        var act = '';
        global$1.each(blocks, function (block) {
            if(act==''){
                act = dom.getStyle(block,'margin-bottom')==value ? 'remove' : 'add';
            }
            if( act=='add' ){
                dom.setStyle(block, 'margin-bottom', value);
            }else{
                var style=dom.getAttrib(block,'style');
                var reg = new RegExp('margin-bottom:[\\s]*' + value + ';', 'ig');
                style = style.replace(reg, '');
                dom.setAttrib(block,'style',style);
            }
        });
    };

    editor.ui.registry.getAll().icons.aftermargin || editor.ui.registry.addIcon('aftermargin','<svg t="1612331995802" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5423" width="24" height="24"><path d="M848 528.064H176c-26.496 0-48 14.336-48 32s21.504 32 48 32h672c26.496 0 48-14.336 48-32s-21.504-32-48-32m-1.024-200h-672c-26.112 0.32-46.976 14.528-46.976 32 0 17.408 20.864 31.616 46.976 32h672c17.408 0.192 33.6-5.824 42.432-15.872a23.168 23.168 0 0 0 0-32.384c-8.832-9.984-25.024-16-42.432-15.744M868.8 128H155.712c-15.168 0-27.456 14.336-27.456 32s12.288 32 27.456 32h713.088c15.168 0 27.456-14.336 27.456-32s-12.288-32-27.456-32M484.736 887.68l-94.208-113.472c-14.208-17.28-3.712-46.08 16.896-46.08h188.288c20.672 0 31.232 28.8 16.96 46.08L518.4 887.68a21.248 21.248 0 0 1-33.728 0" fill="#222f3e" p-id="5424"></path></svg>');

    var stateSelectorAdapter = function (editor, selector) {
        return function (buttonApi) {
            return editor.selection.selectorChangedWithUnbind(selector.join(','), buttonApi.setActive).unbind;
        };
    };

    editor.ui.registry.addSplitButton('aftermargin', {
        text: '',
        icon: 'aftermargin',
        tooltip: '段后距',
        onAction: function () {
            doAct('5px');
        },
        onItemAction: function (api, value) {
            doAct(value);
        },
        fetch: function (callback) {
            var items = [
                {
                    type: 'choiceitem',
                    text: '5px',
                    value: '5px'
                },
                {
                    type: 'choiceitem',
                    text: '10px',
                    value: '10px'
                },
                {
                    type: 'choiceitem',
                    text: '15px',
                    value: '15px'
                },
                {
                    type: 'choiceitem',
                    text: '20px',
                    value: '20px'
                }
            ];
            callback(items);
        }
    });

    editor.addCommand('aftermargin', doAct  );
});
