tinymce.PluginManager.add('beforemargin', function(editor, url) {
    var pluginName='段前距';
    var global$1 = tinymce.util.Tools.resolve('tinymce.util.Tools');
    var doAct = function (value) {
        var dom = editor.dom;
        var blocks = editor.selection.getSelectedBlocks();
        var act = '';
        global$1.each(blocks, function (block) {
            if(act==''){
                act = dom.getStyle(block,'margin-top')==value ? 'remove' : 'add';
            }
            if( act=='add' ){
                dom.setStyle(block, 'margin-top', value);
            }else{
                var style=dom.getAttrib(block,'style');
                var reg = new RegExp('margin-top:[\\s]*' + value + ';', 'ig');
                style = style.replace(reg, '');
                dom.setAttrib(block,'style',style);
            }

        });
    };

    editor.ui.registry.getAll().icons.beforemargin || editor.ui.registry.addIcon('beforemargin','<svg t="1612332056758" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="6088" width="24" height="24"><path d="M894.29333333 493.72273778H129.70666667c-30.14656 0-54.61333333-16.31118222-54.61333334-36.40888889s24.46677333-36.40888889 54.61333334-36.40888889h764.58666666c30.14656 0 54.61333333 16.31118222 54.61333334 36.40888889s-24.46677333 36.40888889-54.61333334 36.40888889m-1.16508444 227.55555555h-764.58666667c-29.70965333-0.36408889-53.44824889-16.52963555-53.44824889-36.40888888 0-19.80643555 23.73859555-35.97198222 53.44824889-36.4088889h764.58666667c19.80643555-0.21845333 38.22933333 6.62641778 48.27818666 18.0588089a26.36003555 26.36003555 0 0 1 0 36.84579555c-10.04885333 11.35957333-28.47175111 18.20444445-48.27818666 17.91317333M917.95911111 948.90666667H106.62343111c-17.25781333 0-31.23882667-16.31118222-31.23882666-36.40888889s13.98101333-36.40888889 31.23882666-36.40888889h811.33568c17.25781333 0 31.23882667 16.31118222 31.23882667 36.40888889s-13.98101333 36.40888889-31.23882667 36.40888889M480.97962667 84.55964445L373.79185778 213.66556445c-16.16554667 19.6608-4.22343111 52.4288 19.22389333 52.4288h214.22990222c23.52014222 0 35.53507555-32.768 19.29671112-52.4288L519.28177778 84.55964445a24.17550222 24.17550222 0 0 0-38.37496889 0" fill="#222f3e" p-id="6089"></path></svg>');

    var stateSelectorAdapter = function (editor, selector) {
        return function (buttonApi) {
            return editor.selection.selectorChangedWithUnbind(selector.join(','), buttonApi.setActive).unbind;
        };
    };

    editor.ui.registry.addSplitButton('beforemargin', {
        text: '',
        icon: 'beforemargin',
        tooltip: '段前距',
        onAction: function () {
            doAct('5px');
        },
        onItemAction: function (api, value) {
            doAct(value);
        },
        fetch: function (callback) {
            var items = [
                {
                    type: 'choiceitem',
                    text: '5px',
                    value: '5px'
                },
                {
                    type: 'choiceitem',
                    text: '10px',
                    value: '10px'
                },
                {
                    type: 'choiceitem',
                    text: '15px',
                    value: '15px'
                },
                {
                    type: 'choiceitem',
                    text: '20px',
                    value: '20px'
                }
            ];
            callback(items);
        }
    });

    editor.addCommand('beforemargin', doAct);
});
